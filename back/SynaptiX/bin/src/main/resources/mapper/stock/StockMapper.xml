<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.mapper.stock.StockMapper">
    <select id="selectAllMaterials" resultType="com.example.demo.model.MaterialDTO">
        SELECT pk, Category AS category, Name AS name, Specification AS specification, Unit AS unit, Price AS price, Stock AS stock, Amount AS amount
        FROM material
    </select>
    <select id="selectAllProducts" resultType="com.example.demo.model.ProductDTO">
        SELECT pk, Category AS category, Name AS name, Model AS model, Specification AS specification, Price AS price, Stock AS stock, Amount AS amount
        FROM product
    </select>
    <select id="selectMaterialsByName" resultType="com.example.demo.model.MaterialDTO">
        SELECT pk, Category AS category, Name AS name, Specification AS specification, Unit AS unit, Price AS price, Stock AS stock, Amount AS amount
        FROM material
        WHERE Name LIKE CONCAT('%', #{name}, '%')
    </select>
    <select id="selectProductsByName" resultType="com.example.demo.model.ProductDTO">
        SELECT pk, Category AS category, Name AS name, Model AS model, Specification AS specification, Price AS price, Stock AS stock, Amount AS amount
        FROM product
        WHERE Name LIKE CONCAT('%', #{name}, '%')
    </select>
    <select id="selectMaterialByPk" resultType="com.example.demo.model.MaterialDTO">
        SELECT pk, Category AS category, Name AS name, Specification AS specification, Unit AS unit, Price AS price, Stock AS stock, Amount AS amount
        FROM material
        WHERE pk = #{pk}
    </select>
    <select id="selectProductByPk" resultType="com.example.demo.model.ProductDTO">
        SELECT pk, Category AS category, Name AS name, Model AS model, Specification AS specification, Price AS price, Stock AS stock, Amount AS amount
        FROM product
        WHERE pk = #{pk}
    </select>
    <update id="updateMaterial" parameterType="com.example.demo.model.MaterialDTO">
        UPDATE material
        SET Category = #{category}, Name = #{name}, Specification = #{specification}, Unit = #{unit}, Price = #{price}, Stock = #{stock}, Amount = #{amount}
        WHERE pk = #{pk}
    </update>
    <update id="updateProduct" parameterType="com.example.demo.model.ProductDTO">
        UPDATE product
        SET Category = #{category}, Name = #{name}, Model = #{model}, Specification = #{specification}, Price = #{price}, Stock = #{stock}, Amount = #{amount}
        WHERE pk = #{pk}
    </update>
    <delete id="deleteMaterial" parameterType="int">
        DELETE FROM material WHERE pk = #{pk}
    </delete>
    <delete id="deleteProduct" parameterType="int">
        DELETE FROM product WHERE pk = #{pk}
    </delete>
    <select id="selectMaterialsByCondition" resultType="com.example.demo.model.MaterialDTO">
        SELECT pk, Category AS category, Name AS name, Specification AS specification, Unit AS unit, Price AS price, Stock AS stock, Amount AS amount
        FROM material
        <where>
            <if test="code != null and code != ''">
                AND pk = #{code}
            </if>
            <if test="name != null and name != ''">
                AND Name LIKE CONCAT('%', #{name}, '%')
            </if>
            <if test="model != null and model != ''">
                AND Specification LIKE CONCAT('%', #{model}, '%')
            </if>
            <if test="category != null and category != ''">
                AND Category = #{category}
            </if>
        </where>
    </select>
    <select id="selectProductsByCondition" resultType="com.example.demo.model.ProductDTO">
        SELECT pk, Category AS category, Name AS name, Model AS model, Specification AS specification, Price AS price, Stock AS stock, Amount AS amount
        FROM product
        <where>
            <if test="code != null and code != ''">
                AND pk = #{code}
            </if>
            <if test="name != null and name != ''">
                AND Name LIKE CONCAT('%', #{name}, '%')
            </if>
            <if test="model != null and model != ''">
                AND Model LIKE CONCAT('%', #{model}, '%')
            </if>
            <if test="category != null and category != ''">
                AND Category = #{category}
            </if>
        </where>
    </select>
    <insert id="insertMaterial" parameterType="com.example.demo.model.MaterialDTO">
        INSERT INTO material (Category, Name, Specification, Unit, Price, Stock, Amount)
        VALUES (#{category}, #{name}, #{specification}, #{unit}, #{price}, #{stock}, #{amount})
    </insert>
    <insert id="insertProduct" parameterType="com.example.demo.model.ProductDTO">
        INSERT INTO product (Category, Name, Model, Specification, Price, Stock, Amount)
        VALUES (#{category}, #{name}, #{model}, #{specification}, #{price}, #{stock}, #{amount})
    </insert>
</mapper>